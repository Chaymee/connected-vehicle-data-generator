import log from 'loglevel';

const appConfig = {
  //"trace","debug","info","warn","error"
  "logLevel": "info",

  // acmeResources/veh_trak/gps/v2/{route}/{vehType}/{vehID}/{lat}/{lng}/{dir}/{status}
  topicPrefix: "sanfran/bus/veh_trak/gps/v2/",
  "mqtt": {
    brokerUrl: "ssl://mr-connection-9hw7diagtnp.messaging.solace.cloud:8883",
    clientOptions: {
      clientId: "solace-cloud-client",
      username: "solace-cloud-client",
      password: "7nt909ai1so0sfav283vical78",
    },
  },
  "vehicles": [
    {
      route: "b1",       // must be the id of a route
      type: "bus",
      number: 10,
      speed: 50,         // km/hour
      IDPrefix: "BD",    // the id will be from IDPrefix+"001" to IDPrefix+"number"
      reportInterval: 2, // seconds
    },
    {
      route: "d1",       // must be the id of a route
      type: "delivery",
      number: 5,
      speed: 50,         // km/hour
      IDPrefix: "DD",    // the id will be from IDPrefix+"001" to IDPrefix+"number"
      reportInterval: 2, // seconds
    },
  ],

  "routes": [
    // type: "OneWayLoop",  default is "RoundTripLoop"
    {
      "id": "b1",
      roadWidth: 5, // default is 10m
      keepTo: "Right", // default is keep to right
      "coordinates": [
        [
          -122.38931397483255,
          37.6624824374628
        ],
        [
          -122.39614866773272,
          37.66221191169352
        ],
        [
          -122.39600221002776,
          37.66082062073592
        ],
        [
          -122.39683213702277,
          37.659313359440645
        ],
        [
          -122.39810143713265,
          37.65819255556268
        ],
        [
          -122.40059121811768,
          37.657033085469564
        ],
        [
          -122.40210461440276,
          37.65529384637999
        ],
        [
          -122.40220225287298,
          37.65328400824856
        ],
        [
          -122.40259280675272,
          37.65212446150386
        ],
        [
          -122.4053755031481,
          37.64976666061952
        ],
        [
          -122.40547314161792,
          37.64682896790052
        ],
        [
          -122.40487156162419,
          37.64516181014666
        ],
        [
          -122.40216445165167,
          37.64597157715899
        ],
        [
          -122.39939718367988,
          37.64682896790208
        ],
        [
          -122.39813386569293,
          37.647162394962734
        ],
        [
          -122.39440406973083,
          37.64725765956253
        ],
        [
          -122.39440406973083,
          37.65002027979678
        ],
        [
          -122.39452438572964,
          37.65183021664558
        ],
        [
          -122.39386264773628,
          37.65259228212122
        ],
        [
          -122.39199774975523,
          37.651639699054186
        ],
        [
          -122.39001253577561,
          37.651687328497815
        ],
        [
          -122.38983206177751,
          37.65249702436493
        ],
        [
          -122.38898984978604,
          37.653211454562125
        ],
        [
          -122.38766637379956,
          37.65349722471737
        ],
        [
          -122.38688431980736,
          37.65473554934522
        ],
        [
          -122.3859819498166,
          37.65549758500515
        ],
        [
          -122.38489910582774,
          37.65559283891305
        ],
        [
          -122.38351547184172,
          37.65516419536604
        ],
        [
          -122.38279357584906,
          37.65444978395641
        ],
        [
          -122.38147009986258,
          37.654164017467835
        ],
        [
          -122.38074820386993,
          37.65444978395641
        ],
        [
          -122.37936456988415,
          37.65625961284522
        ],
        [
          -122.37810125189694,
          37.65716451074701
        ],
        [
          -122.37918409588579,
          37.65806939762035
        ],
        [
          -122.38080836186921,
          37.65883139906535
        ],
        [
          -122.38315452384552,
          37.65921239685497
        ],
        [
          -122.38495926382703,
          37.65911714759065
        ],
        [
          -122.38507957982586,
          37.660212506749914
        ],
        [
          -122.38538036982277,
          37.66187932663503
        ],
        [
          -122.3859819498166,
          37.662641288974186
        ],
        [
          -122.38911016578484,
          37.66249842163171
        ]
      ],
    },
    {
      "id": "d1",
      roadWidth: 5,
      keepTo: "Right",
      "coordinates": [
        [
          -122.3781496628963,
          37.65711104988087
        ],
        [
          -122.37821578805844,
          37.657050100213866
        ],
        [
          -122.37804199467737,
          37.65705439987124
        ],
        [
          -122.37796596007334,
          37.657123194356615
        ],
        [
          -122.37797139111635,
          37.657174790179184
        ],
        [
          -122.37799994871563,
          37.65721738297076
        ],
        [
          -122.37804903214348,
          37.65723736726996
        ],
        [
          -122.37817524667287,
          37.657323965838714
        ],
        [
          -122.37822713486796,
          37.65738169816173
        ],
        [
          -122.37830847312019,
          37.657459414679835
        ],
        [
          -122.37846413770609,
          37.657593753039876
        ],
        [
          -122.37904502061083,
          37.658059596862486
        ],
        [
          -122.37929452513666,
          37.658203381091454
        ],
        [
          -122.37954476914575,
          37.65836621827317
        ],
        [
          -122.38001443020235,
          37.65859906034467
        ],
        [
          -122.38064989170334,
          37.65883593161014
        ],
        [
          -122.3814891410384,
          37.659089583332644
        ],
        [
          -122.3822031088169,
          37.65919329611302
        ],
        [
          -122.38297045369936,
          37.65923123222733
        ],
        [
          -122.38382034531816,
          37.65922472961691
        ],
        [
          -122.38445447862075,
          37.65922519255234
        ],
        [
          -122.3850463619881,
          37.659184127429185
        ],
        [
          -122.38542763854454,
          37.65907487417688
        ],
        [
          -122.38574950373408,
          37.65894492354764
        ],
        [
          -122.38618270786895,
          37.65866348984606
        ],
        [
          -122.38753274419375,
          37.65776516254178
        ],
        [
          -122.38812044017207,
          37.65738824501736
        ],
        [
          -122.38858725777774,
          37.657185476887065
        ],
        [
          -122.38893318179262,
          37.657101870759035
        ],
        [
          -122.38977258385016,
          37.656937025464075
        ],
        [
          -122.39084087623074,
          37.65680022007969
        ],
        [
          -122.39137061777586,
          37.656765195395806
        ],
        [
          -122.39190552650717,
          37.65675571479197
        ],
        [
          -122.3924476540525,
          37.65675205786786
        ],
        [
          -122.39288014930717,
          37.65676126218466
        ],
        [
          -122.39298006596326,
          37.65672720590223
        ],
        [
          -122.39343854416224,
          37.65671933480496
        ],
        [
          -122.39352790350871,
          37.656759885638735
        ],
        [
          -122.39380748058808,
          37.65675105578045
        ],
        [
          -122.39434239257838,
          37.6567277459326
        ],
        [
          -122.39541447192241,
          37.65667071391778
        ],
        [
          -122.39547272928647,
          37.65662190780188
        ],
        [
          -122.39660319619264,
          37.65654182413989
        ],
        [
          -122.39669034616219,
          37.6565812041698
        ],
        [
          -122.39696451806807,
          37.656563235017444
        ],
        [
          -122.39749836357485,
          37.65653029587854
        ],
        [
          -122.39801964969794,
          37.65643704453143
        ],
        [
          -122.39849617568909,
          37.656246506505056
        ],
        [
          -122.3990449710373,
          37.65580669358731
        ],
        [
          -122.39931892288644,
          37.655446835173464
        ],
        [
          -122.39957728806002,
          37.655070590746476
        ],
        [
          -122.3998360377663,
          37.65470735301376
        ],
        [
          -122.3999559885734,
          37.6545401542304
        ],
        [
          -122.40030628331155,
          37.65454981330164
        ],
        [
          -122.4008426560803,
          37.65454796331137
        ],
        [
          -122.40167879257014,
          37.654558458962086
        ],
        [
          -122.40220617737103,
          37.65463036722255
        ],
        [
          -122.4026422079883,
          37.654745201554434
        ],
        [
          -122.40311934048079,
          37.65493326276078
        ],
        [
          -122.40368298597514,
          37.65520658357018
        ],
        [
          -122.40414307402551,
          37.65542772131833
        ],
        [
          -122.40457321548942,
          37.65563833598037
        ],
        [
          -122.40484839623485,
          37.655735161608916
        ],
        [
          -122.40507771798858,
          37.65576855384842
        ],
        [
          -122.40534802969475,
          37.655756488605704
        ],
        [
          -122.40560189216295,
          37.65569385043075
        ],
        [
          -122.40601149873808,
          37.65542818276893
        ],
        [
          -122.40609066755569,
          37.65534761658958
        ],
        [
          -122.40637885101299,
          37.65503576999467
        ],
        [
          -122.40667079368885,
          37.65476100275079
        ],
        [
          -122.40674875130944,
          37.65473081688123
        ],
        [
          -122.40695276811388,
          37.654658357310296
        ],
        [
          -122.40725779490687,
          37.654654064661514
        ],
        [
          -122.40768732278976,
          37.65470112541905
        ],
        [
          -122.40760693067357,
          37.654907641686464
        ],
        [
          -122.40740177822897,
          37.65502165201893
        ],
        [
          -122.40727559198761,
          37.65504052027414
        ],
        [
          -122.40705399207596,
          37.65500524559435
        ],
        [
          -122.40687311560791,
          37.65498661232223
        ],
        [
          -122.40670681367446,
          37.65498429187437
        ],
        [
          -122.40657209050244,
          37.65504288771997
        ],
        [
          -122.40651505622974,
          37.655136794808044
        ],
        [
          -122.40649321513423,
          37.65521621467104
        ],
        [
          -122.40642839306906,
          37.655637172985564
        ],
        [
          -122.40634948305193,
          37.65605395994879
        ],
        [
          -122.4062139186357,
          37.65645987969043
        ],
        [
          -122.4060447243423,
          37.65685983357727
        ],
        [
          -122.40586776079166,
          37.657272647931705
        ]
      ]
    },
  ],
}

function checkConfig() {
  try {
    const routeIDs = appConfig.routes.map(r => r.id)
    for (const veh of appConfig.vehicles) {
      if (routeIDs.indexOf(veh.route) == -1) {
        log.error(`Can NOT find route with id==${veh.route} in ${fileName}`)
        process.exit(1)
      }
      if (!Number.isInteger(veh.number)) {
        log.error(`The number ${veh.number} of vehicle('${veh.type}') must be integer`)
        process.exit(1)
      }
    }
  } catch (err) {
    log.error(err);
    return null
  }
}
const logLevel = appConfig.logLevel
log.setLevel(logLevel)
checkConfig()
export { appConfig }